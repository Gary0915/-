# 智慧太陽能監控系統：自動追蹤與環境監測 (Intelligent Solar Monitoring System: Auto-Tracking and Environmental Sensing)

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

本專案旨在開發一套智慧太陽能監控系統，透過自動追蹤太陽光以最大化發電效率，並結合即時環境數據監測，將所有資訊整合於雲端儀表板，提供使用者直觀、易用的操作介面。

---

## 目錄
- [專案背景與目的](#專案背景與目的)
- [技術基礎](#技術基礎)
- [系統架構與設計](#系統架構與設計)
- [系統實作](#系統實作)
- [系統畫面](#系統畫面)
- [討論與分析](#討論與分析)
- [團隊成員](#團隊成員)

## 專案背景與目的

### 背景
太陽能板的發電效率與太陽光的入射角度密切相關。傳統的固定式太陽能板因無法隨太陽位置變化而調整角度，導致發電效率不佳。手動調整不僅費時費力，也無法即時應對天氣變化，因此，一套能夠自動追蹤太陽並監測環境的系統至關重要。

### 專案目的
本專案的核心目標是實現一個能**自動追蹤太陽光線的系統**，並結合**前端網頁儀表板**，達成環境數據的即時監控與視覺化顯示，從而提升太陽能板的整體效能。

## 技術基礎

本專案的實現依賴於以下幾項關鍵技術：

- **太陽能追蹤**：採用**雙軸伺服馬達**搭配位於四個方位的**光敏電阻(LDR)**。系統透過比較四個 LDR 的光照強度差異，來判斷太陽的方位，並驅動馬達進行精準追蹤。
- **馬達應用**：深入比較了 180 度與 360 度伺服馬達的特性，包含 `PWM`（脈衝寬度調變）控制方式與角度設定的差異，以選擇最適合的硬體方案。
- **ESP32 與 Arduino 整合**：探討 `Arduino`（負責底層控制）與 `ESP32`（負責網路通訊）之間的分工合作模式。我們研究了兩者透過**序列 (Serial) 及 I2C 通訊協定**進行資料交換的優點與必要性。

## 系統架構與設計

整個系統分為硬體、軟體、雲端與前端四個主要部分。

### 硬體設計
- **Arduino 端**：主要負責底層控制，包含讀取光敏電阻陣列的數值、驅動伺服馬達進行角度調整，以及透過 LCD 螢幕顯示本機狀態。
- **ESP32 端**：作為系統的通訊與數據中心，負責讀取環境感測器（如溫濕度、氣壓）的數據，並透過 Wi-Fi 將資料傳送到雲端。

### 軟體設計
- **Arduino 程式**：核心邏輯在於即時偵測 LDR 的光照強度，透過演算法計算出太陽能板的最佳俯仰角與方位角，並生成對應的 PWM 訊號來控制馬達轉動。同時，將系統狀態等關鍵資訊顯示在 LCD 上。
- **ESP32 程式**：負責讀取各類環境感測器的數據，將其封裝成標準的 JSON 格式，並透過 HTTP POST 請求將資料穩定地傳輸至雲端伺服器。

### 雲端架構
- **Cloudflare Workers**：我們使用 Cloudflare Workers 作為無伺服器 (Serverless) 的後端服務。它負責接收由 ESP32 發送的 HTTP POST 請求，解析傳入的 JSON 數據，並將其寫入資料庫。
- **Cloudflare KV**：這是一個高效能的鍵值對 (Key-Value) 分散式資料庫，用於儲存即時的環境感測器數據，並提供給前端網頁快速讀取。

### 前端網頁
- **Vite + React**：採用現代化的前端開發工具 `Vite` 與 `React` 框架來建構一個高效能的單頁應用程式（SPA）。
- **儀表板功能**：前端儀表板會定期從 Cloudflare KV 拉取最新的環境數據，並以圖表、儀表盤和數值卡片的形式動態呈現，為使用者提供一目了然的監控介面。

## 系統實作



### 軟體程式碼
- **Arduino**：包含 LDR 光強偵測、馬達 PID 控制與 LCD 顯示的核心程式碼。
- **ESP32**：包含 BME280 等感測器的讀取、Wi-Fi 連線管理與 HTTP POST 資料傳輸的程式碼。
- **Cloudflare Worker**：處理 API 請求、驗證數據格式並寫入 KV 資料庫的 TypeScript/JavaScript 程式碼。

## 系統畫面

### 登入頁面與天氣預報

<img src="https://github.com/user-attachments/assets/782e0172-c4bd-4329-8858-fea281d8effd" width="400px" alt="登入系統" />
<img src="https://github.com/user-attachments/assets/249d1268-0d6c-45d4-a78a-7373c401b5ac" width="800px" alt="天氣預報" />


### 數據儀表板
儀表板顯示即時的環境數據，包含溫度、濕度、氣壓和海拔，並提供歷史數據走勢圖。
<img width="1430" height="446" alt="image" src="https://github.com/user-attachments/assets/8c0fe16a-6b93-464b-a928-16cb477363e2" />
<img width="1457" height="734" alt="image" src="https://github.com/user-attachments/assets/711098d2-cd49-430a-b057-b8ebcf880909" />

### Cloudflare KV 數據庫
後端數據儲存的狀態，顯示感測器數據以 Key-Value 形式儲存。
<img width="1046" height="774" alt="image" src="https://github.com/user-attachments/assets/4a2f78d3-2c05-4c17-81b2-698b92e769ae" />


## 討論與分析

### 技術限制
- **Arduino 運算能力**：Arduino 的微控制器運算能力有限，在未來引入更複雜的追蹤演算法（如機器學習預測）時可能會遇到性能瓶頸。
- **網路穩定性**：ESP32 的網路通訊完全依賴於 Wi-Fi 的穩定性，在訊號不佳的環境中可能導致數據上傳延遲或失敗。
- **KV 儲存限制**：免費版的 Cloudflare KV 在寫入頻率、儲存容量及單一 Value 大小上均有一定限制，對於高頻數據記錄的場景需要考慮升級方案。

### 已解決的系統問題
- **馬達抖動**：透過在 Arduino 端引入軟體濾波演算法並微調 PID 控制參數，成功減少了因光線微小變化或電氣雜訊所造成的馬達不必要抖動。
- **通訊錯誤**：在 ESP32 的程式中加入了連線重試與錯誤處理機制，當數據上傳失敗時會嘗試重新傳送，大幅提升了數據傳輸的可靠性。

### 未來拓展
- **整合更多感測器**：可考慮加入風速計、雨量感測器或 PM2.5 感測器，提供更全面的環境監測數據。
- **開發行動 APP**：建立跨平台的行動應用程式（iOS/Android），讓使用者能隨時隨地監控系統狀態，並提供即時推播警示功能（如過熱、發電異常）。
- **數據分析與預測**：利用長期收集的歷史數據，導入機器學習模型來預測未來一小時或一日的發電量，或進行設備異常狀態的預測性維護。

## 團隊成員
**組別：4**
| 學號 | 姓名 |
| :--- | :--- |
| B11103014 | 黃勖希 |
| B11103038 | 陳宥均 |
| B11103015 | 蘇楷恩 |
| B11103146 | 蘇厚聞 |
| B11103031 | 童宥翔 |
